(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4746c2bc"],{"0fea":function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return c}));var r=s("b775"),i="",n={user:"".concat(i,"/user"),role:"".concat(i,"/role"),service:"".concat(i,"/service"),permission:"".concat(i,"/permission"),permissionNoPager:"".concat(i,"/permission/no-pager"),orgTree:"".concat(i,"/org/tree")};function a(e){return Object(r["a"])({url:n.role,method:"get",params:e})}function o(e){return Object(r["a"])({url:n.service,method:"get",params:e})}function c(e){return Object(r["a"])({url:n.orgTree,method:"get",params:e})}},"98bb":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-card",{style:{height:"100%"},attrs:{bordered:!1}},[s("a-row",{attrs:{gutter:24}},[s("a-col",{attrs:{md:4}},[s("a-list",{attrs:{"item-layout":"vertical","data-source":e.roles},scopedSlots:e._u([{key:"renderItem",fn:function(t,r){return s("a-list-item",{key:r},[s("a-list-item-meta",{style:{marginBottom:"0"}},[s("span",{staticStyle:{"text-align":"center",display:"block"},attrs:{slot:"description"},slot:"description"},[e._v(e._s(t.describe))]),s("a",{staticStyle:{"text-align":"center",display:"block"},attrs:{slot:"title"},on:{click:function(s){return e.edit(t)}},slot:"title"},[e._v(e._s(t.name))])])],1)}}])})],1),s("a-col",{attrs:{md:20}},[s("div",{staticStyle:{"max-width":"800px"}},[e.isMobile()?s("a-divider"):e._e(),e.mdl.id?s("div",[s("h3",[e._v("角色："+e._s(e.mdl.name))])]):e._e(),s("a-form",{attrs:{form:e.form,layout:e.isMobile()?"vertical":"horizontal"}},[s("a-form-item",{attrs:{label:"唯一键"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"Please input unique key!"}]}],expression:"['id', { rules: [{ required: true, message: 'Please input unique key!' }] }]"}],attrs:{placeholder:"请填写唯一键"}})],1),s("a-form-item",{attrs:{label:"角色名称"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"Please input role name!"}]}],expression:"['name', { rules: [{ required: true, message: 'Please input role name!' }] }]"}],attrs:{placeholder:"请填写角色名称"}})],1),s("a-form-item",{attrs:{label:"状态"}},[s("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{rules:[]}],expression:"['status', { rules: [] }]"}]},[s("a-select-option",{attrs:{value:1}},[e._v("正常")]),s("a-select-option",{attrs:{value:2}},[e._v("禁用")])],1)],1),s("a-form-item",{attrs:{label:"备注说明"}},[s("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe",{rules:[{required:!0,message:"Please input role name!"}]}],expression:"['describe', { rules: [{ required: true, message: 'Please input role name!' }] }]"}],attrs:{row:3,placeholder:"请填写角色名称"}})],1),s("a-form-item",{attrs:{label:"拥有权限"}},e._l(e.permissions,(function(t,r){return s("a-row",{key:r,attrs:{gutter:16}},[s("a-col",{attrs:{xl:4,lg:24}},[e._v(e._s(t.name)+"：")]),s("a-col",{attrs:{xl:20,lg:24}},[t.actionsOptions.length>0?s("a-checkbox",{attrs:{indeterminate:t.indeterminate,checked:t.checkedAll},on:{change:function(s){return e.onChangeCheckAll(s,t)}}},[e._v(" 全选 ")]):e._e(),s("a-checkbox-group",{attrs:{options:t.actionsOptions},on:{change:function(s){return e.onChangeCheck(t)}},model:{value:t.selected,callback:function(s){e.$set(t,"selected",s)},expression:"permission.selected"}})],1)],1)})),1)],1)],1)])],1)],1)},i=[],n=(s("4160"),s("d81d"),s("159b"),s("0fea")),a=s("ac0d"),o={name:"RoleList",components:{},mixins:[a["c"]],data:function(){return{form:this.$form.createForm(this),mdl:{},roles:[],permissions:[]}},created:function(){var e=this;Object(n["b"])().then((function(t){e.roles=t.result.data,e.roles.push({id:"-1",name:"新增角色",describe:"新增一个角色"}),console.log("this.roles",e.roles)})),this.loadPermissions()},methods:{callback:function(e){console.log(e)},add:function(){this.edit({id:0})},edit:function(e){var t=this;if(this.mdl=Object.assign({},e),this.mdl.permissions&&this.permissions){var s={};this.mdl.permissions.forEach((function(e){s[e.permissionId]=e.actionEntitySet.map((function(e){return e.action}))})),console.log("permissionsAction",s),this.permissions.forEach((function(e){var r=s[e.id];e.selected=r||[],t.onChangeCheck(e)})),console.log("this.permissions",this.permissions)}this.$nextTick((function(){t.form.setFieldsValue(t.$g.pick(t.mdl,"id","name","status","describe"))})),console.log("this.mdl",this.mdl)},onChangeCheck:function(e){e.indeterminate=!!e.selected.length&&e.selected.length<e.actionsOptions.length,e.checkedAll=e.selected.length===e.actionsOptions.length},onChangeCheckAll:function(e,t){console.log("permission:",t),Object.assign(t,{selected:e.target.checked?t.actionsOptions.map((function(e){return e.value})):[],indeterminate:!1,checkedAll:e.target.checked})},loadPermissions:function(){}}},c=o,l=s("2877"),u=Object(l["a"])(c,r,i,!1,null,"661d8e80",null);t["default"]=u.exports}}]);