(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-90dfd560"],{"0fea":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return l}));var s=a("b775"),r="",o={user:"".concat(r,"/user"),role:"".concat(r,"/role"),service:"".concat(r,"/service"),permission:"".concat(r,"/permission"),permissionNoPager:"".concat(r,"/permission/no-pager"),orgTree:"".concat(r,"/org/tree")};function n(e){return Object(s["b"])({url:o.role,method:"get",params:e})}function i(e){return Object(s["b"])({url:o.service,method:"get",params:e})}function l(e){return Object(s["b"])({url:o.orgTree,method:"get",params:e})}},"334f":function(e,t,a){},"8b8b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"角色ID"}},[a("a-input",{attrs:{placeholder:"请输入"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"状态"}},[a("a-select",{attrs:{placeholder:"请选择","default-value":"0"}},[a("a-select-option",{attrs:{value:"0"}},[e._v("全部")]),a("a-select-option",{attrs:{value:"1"}},[e._v("关闭")]),a("a-select-option",{attrs:{value:"2"}},[e._v("运行中")])],1)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v("重置")])],1)])],1)],1)],1),a("s-table",{attrs:{"row-key":"id",size:"default",columns:e.columns,data:e.loadData,"expanded-row-keys":e.expandedRowKeys},on:{expand:e.handleExpand},scopedSlots:e._u([{key:"expandedRowRender",fn:function(t){return a("div",{staticStyle:{margin:"0"}},[a("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},e._l(t.permissions,(function(t,s){return a("a-col",{key:s,style:{marginBottom:"12px",height:"23px"},attrs:{span:12}},[a("a-col",{attrs:{lg:4,md:24}},[a("span",[e._v(e._s(t.permissionName)+"：")])]),t.actionList&&t.actionList.length>0?a("a-col",{attrs:{lg:20,md:24}},e._l(t.actionList,(function(t){return a("a-tag",{key:t,attrs:{color:"cyan"}},[e._v(" "+e._s(e._f("permissionFilter")(t))+" ")])})),1):a("a-col",{attrs:{span:20}},[e._v("-")])],1)})),1)],1)}},{key:"status",fn:function(t){return a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(e._f("statusFilter")(t)))])}},{key:"createTime",fn:function(t){return a("span",{},[e._v(e._s(e._f("moment")(t)))])}},{key:"action",fn:function(t,s){return a("span",{},[a("a",{on:{click:function(t){return e.handleEdit(s)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v(" 更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{attrs:{href:"javascript:;"}},[e._v("详情")])]),a("a-menu-item",[a("a",{attrs:{href:"javascript:;"}},[e._v("禁用")])]),a("a-menu-item",[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])],1)],1)],1)}}])}),a("a-modal",{staticStyle:{top:"20px"},attrs:{title:"操作",width:800},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form",{staticClass:"permission-form",attrs:{form:e.form}},[a("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"唯一识别码","has-feedback":"","validate-status":"success"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{placeholder:"唯一识别码",disabled:"disabled"}})],1),a("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"角色名称","has-feedback":"","validate-status":"success"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name"],expression:"['name']"}],attrs:{placeholder:"起一个名字"}})],1),a("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"状态","has-feedback":"","validate-status":"warning"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:1}],expression:"['status', { initialValue: 1 }]"}]},[a("a-select-option",{attrs:{value:1}},[e._v("正常")]),a("a-select-option",{attrs:{value:2}},[e._v("禁用")])],1)],1),a("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"描述","has-feedback":""}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe"],expression:"['describe']"}],attrs:{id:"describe",rows:5,placeholder:"..."}})],1),a("a-divider",[e._v("拥有权限")]),e._l(e.permissions,(function(t){return[t.actionsOptions&&t.actionsOptions.length>0?a("a-form-item",{key:t.permissionId,staticClass:"permission-group",attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:t.permissionName}},[a("a-checkbox",[e._v("全选")]),a("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["permissions."+t.permissionId],expression:"[`permissions.${permission.permissionId}`]"}],attrs:{options:t.actionsOptions}})],1):e._e()]}))],2)],1)],1)},r=[],o=(a("4de4"),a("d81d"),a("f3f3")),n=a("2af9"),i=a("0fea"),l={1:"启用",2:"禁用"},c=[{title:"唯一识别码",dataIndex:"id"},{title:"角色名称",dataIndex:"name"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"创建时间",dataIndex:"createTime",scopedSlots:{customRender:"createTime"},sorter:!0},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],d={name:"TableList",components:{STable:n["q"]},filters:{statusFilter:function(e){return l[e]},permissionFilter:function(e){}},data:function(){var e=this;return{description:"列表使用场景：后台管理中的权限管理以及角色管理，可用于基于 RBAC 设计的角色权限控制，颗粒度细到每一个操作类型。",visible:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:this.$form.createForm(this),permissions:[],advanced:!1,queryParam:{},columns:c,loadData:function(t){return Object(i["b"])(t).then((function(t){return console.log("getRoleList",t),e.expandedRowKeys=t.result.data.map((function(e){return e.id})),t.result}))},expandedRowKeys:[],selectedRowKeys:[],selectedRows:[]}},watch:{},created:function(){Object(i["c"])().then((function(e){console.log("getServiceList.call()",e)})),Object(i["b"])().then((function(e){console.log("getRoleList.call()",e)}))},methods:{handleEdit:function(e){var t=this;this.visible=!0,console.log("record",e);var a={};this.permissions=e.permissions.map((function(e){var t="permissions.".concat(e.permissionId);a[t]=e.actionList;var s=e.actionEntitySet.map((function(e){return{label:e.describe,value:e.action,defaultCheck:e.defaultCheck}}));return Object(o["a"])({},e,{actionsOptions:s})})),this.$nextTick((function(){console.log("permissions",t.permissions),console.log("checkboxGroup",a),t.form.setFieldsValue(t.$g.pick(e,["id","status","describe","name"])),t.form.setFieldsValue(a)}))},handleOk:function(e){e.preventDefault(),this.form.validateFields((function(e,t){console.log(e,t)}))},onChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleExpand:function(e,t){console.log("expanded",e,t),e?this.expandedRowKeys.push(t.id):this.expandedRowKeys=this.expandedRowKeys.filter((function(e){return t.id!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced}}},u=d,p=(a("f14c"),a("2877")),m=Object(p["a"])(u,s,r,!1,null,"131da356",null);t["default"]=m.exports},f14c:function(e,t,a){"use strict";var s=a("334f"),r=a.n(s);r.a}}]);